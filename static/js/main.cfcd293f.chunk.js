(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,n){e.exports=n(132)},108:function(e,t,n){},132:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(61),o=n.n(c),i=n(31),l=n(26),s=n(99),u=n(91),m=(n(108),n(27)),d=n(28),h=n(34),p=n(29),g=n(35),f=n(19),v=n(20),b=n(6),O="containers/SearchPage/actions/LOAD_AVAILABILITY_SUCCESS",E="containers/SearchPage/actions/LOAD_AVAILABILITY_FAILURE",y="containers/SearchPage/actions/LOAD_CRIME_CATEGORY_REQUEST",x="containers/SearchPage/actions/LOAD_CRIME_CATEGORY_SUCCESS",j="containers/SearchPage/actions/LOAD_CRIME_CATEGORY_FAILURE",w="containers/SearchPage/actions/SEARCH_REQUEST",C="containers/SearchPage/actions/SEARCH_SUCCESS",k="containers/SearchPage/actions/SEARCH_FAILURE";function S(e){return{type:k,message:e}}function A(){var e=Object(f.a)(["\n    order: 1;\n    margin: 0.5rem;\n    padding: 0.5rem;\n\n    .grid-container {\n      display: grid;\n      grid-template-rows: 2rem 2rem 2rem 2rem;\n      grid-template-columns: 7.5rem auto;\n\n      .grid-item {\n        padding: 0.5rem 1rem;\n        \n        &.submit {\n          grid-column-start: 1;\n          grid-column-end: 3;\n        }\n      }\n    }\n\n    label {\n      font-size: smaller;\n      text-transform: uppercase;\n    }\n\n    button {\n      background-color: black;\n      color: white;\n      padding: 0.3rem 1rem;\n      font-weight: bolder;\n    }\n"]);return A=function(){return e},e}var _=v.a.div(A()),N=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(p.a)(t).call(this))).changeDate=function(t){var n=t.target.value&&t.target.value.split("-");if(n){var a="".concat(n[0],"-").concat(n[1]);e.setState({date:a}),e.props.onLoadCrimeCategory(a)}},e.changeCategory=function(t){e.crimeCategory=t.target.value},e.search=function(t){t.preventDefault(),e.props.onSearch({url:e.crimeCategory||"all-crimes",date:e.state.date||e.state.minmax.max})},e.toggleModal=function(){return e.setState({showError:!e.state.showError})},e.state={date:null,minmax:{},forces:[]},e}return Object(g.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this,n=e.availability,a=this.props.availability;if(n!==a){var r=a.reduce(function(e,t){return{min:e.min&&e.min<t.date?e.min:t.date,max:e.max&&e.max>t.date?e.max:t.date}},{}),c=(a.find(function(e){var n=e.date;return(t.state.date||r.max||"").indexOf(n)>-1})||{})["stop-and-search"];this.setState({minmax:r,forces:c})}}},{key:"render",value:function(){var e=this.state,t=e.date,n=e.minmax,a=e.forces,c=this.props.crimeCategory,o=void 0===c?[{url:"all-crimes",name:"all crimes"}]:c;return r.a.createElement(_,null,r.a.createElement("form",{className:"grid-container"},r.a.createElement("label",{htmlFor:"input_date",className:"grid-item"},"date"),r.a.createElement("input",{type:"date",id:"input_date",min:"".concat(n.min,"-01"),max:"".concat(n.max,"-31"),value:t||"".concat(n.max,"-31"),onChange:this.changeDate,required:!0,className:"grid-item"}),r.a.createElement("label",{htmlFor:"select_category",className:"grid-item"},"category"),r.a.createElement("select",{id:"select_category",onChange:this.changeCategory,className:"grid-item"},o&&o.map(function(e){var t=e.url,n=e.name;return r.a.createElement("option",{key:t,value:t},n)})),r.a.createElement("label",{htmlFor:"select_force",className:"grid-item"},"force"),r.a.createElement("select",{id:"select_force",className:"grid-item"},a&&a.map(function(e){return r.a.createElement("option",{key:e,value:e},e)})),r.a.createElement("button",{onClick:this.search,className:"grid-item submit"},"SEARCH")))}}]),t}(r.a.PureComponent),I=Object(i.b)(function(e){return Object(b.a)({},e.search)},function(e){return{onLoadCrimeCategory:function(){return e({type:y,date:t});var t},onSearch:function(t){return e({type:w,params:t})}}})(N),L=n(135),T=n(137),R=n(134),P=n(138),M=n(136),D="containers/MapPage/actions/SAVE_LOCATION";var U="containers/AnalysePage/SAVE_STREET_ID",F="containers/AnalysePage/EXTRACT_DATA_SUCCESS",z="containers/AnalysePage/EXTRACT_DATA_FAILURE";var Y=["palevioletred","indianred","mediumvioletred","darkred","orangered","red"],B=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(h.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(e){var t=e.latlng;n.props.onSaveLocation(t)},n.clickCircle=function(e){return function(){n.props.onSaveStreetId(e)}},n}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.latlng,a=t.locations;return r.a.createElement(L.a,{center:n,ref:function(t){e.map=t},zoom:13,onClick:this.handleClick},r.a.createElement(T.a,{attribution:"&amp;copy <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),n&&r.a.createElement(R.a,{position:[n.lat,n.lng]},r.a.createElement(P.a,null,"You clicked here!!\n            Latitude: ".concat(n.lat,"\n            Longitude: ").concat(n.lng))),a&&a.map(function(t){var n=t.latlng,a=t.street,c=t.count;return r.a.createElement(M.a,{fillColor:c>=Y.length?Y[Y.length-1]:Y[c-1],fillOpacity:1,stroke:!1,radius:25*c,center:n,key:n,onClick:e.clickCircle(a.id)},r.a.createElement(P.a,null,"Street Id: ".concat(a.id,"\n            Street Name: ").concat(a.name,"\n            Crime Count: ").concat(c)))}))}}]),t}(r.a.PureComponent),G=Object(i.b)(function(e){return Object(b.a)({},e.map)},function(e){return{onSaveLocation:function(t){return e({type:D,data:t})},onSaveStreetId:function(t){return e(function(e){return{type:U,id:e}}(t))}}})(B),H=n(100);function V(){var e=Object(f.a)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.6);\n\n  .modal-title {\n    height: 3rem;\n    background-color: black;\n    color: white;\n    vertical-align: middle;\n    line-height: 3rem;\n    text-align: center;\n  }\n\n  .modal-main {\n    position: fixed;\n    background: white;\n    width: 100%;\n    height: calc(100% - 6rem);\n    overflow: auto;\n    top: 3rem;\n    left: 50%;\n    transform: translateX(-50%);\n  }\n\n  .modal-footer {\n    position: fixed;\n    top: calc(100% - 3rem);\n    height: 3rem;\n    background-color: white;\n    width: 100%;\n    line-height: 3rem;\n    vertical-align: middle;\n    text-align: center;\n    border-top: 1px solid black;\n    box-sizing: border-box;\n\n    .close {\n      background-color: black;\n      color: white;\n      font-weight: bolder;\n      padding: 0.5rem 1rem;\n    }\n  }\n"]);return V=function(){return e},e}var q=v.a.div(V()),W=function(e){var t=e.title,n=e.show,a=e.onClose,c=e.children;return r.a.createElement(q,{className:"display-".concat(n?"block":"none")},r.a.createElement("div",{className:"modal-title"},t),r.a.createElement("div",{className:"modal-main"},c),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{className:"close",onClick:a},"Close")))};function X(){var e=Object(f.a)(["\n  margin: 0.5rem auto;\n  display: table;\n\n  box-shadow: 3px 3px 1px 1px;\n  border-radius: 0.5rem;\n  padding: 0.5rem 1rem;\n\n  .tr {\n    display: table-row;\n  }\n\n  .th {\n    display: table-cell;\n    font-weight: 600;\n  }\n\n  .td {\n    display: table-cell;\n  }\n"]);return X=function(){return e},e}var J=v.a.div(X()),Q=function(e){var t=e.children;return r.a.createElement(J,null,t)},$=function(e){var t=e.children;return r.a.createElement("div",{className:"tr"},t)},K=function(e){var t=e.children;return r.a.createElement("div",{className:"th"},t)},Z=function(e){var t=e.children;return r.a.createElement("div",{className:"td"},t)},ee=function(e){var t=e.show,n=e.onClose,a=e.title,c=e.crimes;return r.a.createElement(W,{show:t,onClose:n,title:a},c&&c.map(function(e){var t=e.id,n=e.list;return r.a.createElement(Q,{key:t},n.map(function(e){var t=Object(H.a)(e,2),n=t[0],a=t[1];return r.a.createElement($,{key:n},r.a.createElement(K,null,n),r.a.createElement(Z,null,a))}))}))};function te(){var e=Object(f.a)(["\n  .tr {\n    line-height: 2rem;\n\n    .th {\n      font-size: smaller;\n    }\n\n    .td {\n      padding: 0 0.5rem;\n    }\n  }\n"]);return te=function(){return e},e}var ne=v.a.div(te()),ae=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(p.a)(t).call(this))).toggleModal=function(){return e.setState({showModal:!e.state.showModal})},e.state={showModal:!1},e}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.crimeTable;return r.a.createElement(ne,null,e&&e.length>0&&r.a.createElement("button",{onClick:this.toggleModal},"Crime List"),r.a.createElement("button",null,"Guardian News"),r.a.createElement(ee,{show:this.state.showModal,onClose:this.toggleModal,title:"The list of crimes",crimes:e}))}}]),t}(r.a.PureComponent),re=Object(i.b)(function(e){return Object(b.a)({},e.analyse)})(ae);function ce(){var e=Object(f.a)(["\n  display: flex;\n  flex-direction: column;\n\n  header {\n    order: 0;\n    background: darkslateblue;\n    color: yellow;\n    line-height: 2rem;\n    height: 4rem;\n    vertical-align: middle;\n    padding: 0;\n    margin: 0;\n    text-align: center;\n    position: relative;\n\n    .title {\n      text-align: center;\n      font-size: larger;\n      font-weight: bolder;\n    }\n\n    .email {\n      text-align: right;\n      padding: 0 1rem;\n      font-size: small;\n    }\n  }\n\n  aside {\n    order: 1;\n  }\n\n  .map {\n    order: 2;\n    height: 32.5rem;\n    z-index: 0;\n\n    .leaflet-container {\n      height: 100%;\n      margin: 0.5rem;\n      border-radius: 1.5rem;\n    }\n  }\n\n  .analyse {\n    order: 3;\n    height: 50rem;\n    padding: 1rem;\n    overflow: auto;\n  }\n"]);return ce=function(){return e},e}var oe=v.a.div(ce()),ie=function(e){function t(){return Object(m.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(oe,null,r.a.createElement("header",null,r.a.createElement("div",{className:"title"},"CRIME MAP"),r.a.createElement("div",{className:"email"},r.a.createElement("span",{className:"smaller"},"Contact me: melancholy14@hotmail.com"))),r.a.createElement("aside",null,r.a.createElement(I,null)),r.a.createElement("main",{className:"map"},r.a.createElement(G,null)),r.a.createElement("main",{className:"analyse"},r.a.createElement(re,null)))}}]),t}(a.Component),le={availability:[],crimeCategory:[],message:null};var se=n(59),ue={latlng:{lat:51.505,lng:-.09}};var me={streetId:0};var de=Object(l.combineReducers)({map:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return Object(b.a)({},e,{latlng:t.data});case C:return Object(b.a)({},e,{locations:Object.values(t.data.reduce(function(e,t){var n=t.location,a=(n=void 0===n?{}:n).latitude,r=n.longitude,c=n.street,o=void 0===c?{}:c;return e[o.id]?Object(b.a)({},e,Object(se.a)({},o.id,Object(b.a)({},e[o.id],{count:e[o.id].count+1}))):Object(b.a)({},e,Object(se.a)({},o.id,{street:o,count:1,latlng:[parseFloat(a),parseFloat(r)]}))},{}))});default:return e}},search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return Object(b.a)({},e,{availability:t.data});case x:return Object(b.a)({},e,{crimeCategory:t.data});case C:return Object(b.a)({},e,{crimes:t.data});case E:case j:case k:return Object(b.a)({},e,{message:t.message});default:return e}},analyse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U:return Object(b.a)({},e,{streetId:t.id});case F:return Object(b.a)({},e,t.data);case z:return Object(b.a)({},e,{message:t.message});default:return e}}}),he=n(8),pe=n.n(he),ge=n(4),fe=n(97),ve=n(98),be=n.n(ve),Oe={police:"https://data.police.uk/api",guardian:"https://content.guardianapis.com/search"};function Ee(e){return ye.apply(this,arguments)}function ye(){return(ye=Object(fe.a)(pe.a.mark(function e(t){var n,a;return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.status>=200&&t.status<300)){e.next=4;break}return e.abrupt("return",t);case 4:return(n=new Error).response=t,e.prev=6,e.next=9,t.json();case 9:throw a=e.sent,n.body=a,n.message=a.message||t.statusText,n;case 15:throw e.prev=15,e.t0=e.catch(6),e.t0;case 18:case"end":return e.stop()}},e,this,[[6,15]])}))).apply(this,arguments)}function xe(e){return 204===e.status||205===e.status?null:e}function je(e,t){return be.a.get(e,t).then(Ee).then(xe)}var we=pe.a.mark(Ae),Ce=pe.a.mark(_e),ke=pe.a.mark(Ne),Se=pe.a.mark(Ie);function Ae(){var e;return pe.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,je("".concat(Oe.police,"/crimes-street-dates"));case 3:return e=t.sent,t.next=6,Object(ge.c)((a=e.data,{type:O,data:a}));case 6:t.next=13;break;case 8:return t.prev=8,t.t0=t.catch(0),console.log(t.t0),t.next=13,Object(ge.c)((n=t.t0.message,{type:E,message:n}));case 13:case"end":return t.stop()}var n,a},we,this,[[0,8]])}function _e(){var e,t,n,a,r=arguments;return pe.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:{},t=e.date,c.prev=1,n=t||(new Date).toLocaleDateString(),c.next=5,je("".concat(Oe.police,"/crime-categories?date=").concat(n));case 5:return a=c.sent,c.next=8,Object(ge.c)((i=a.data,{type:x,data:i}));case 8:c.next=15;break;case 10:return c.prev=10,c.t0=c.catch(1),console.log(c.t0),c.next=15,Object(ge.c)((o=c.t0.message,{type:j,message:o}));case 15:case"end":return c.stop()}var o,i},Ce,this,[[1,10]])}function Ne(e){var t,n,a,r,c,o,i;return pe.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.params,l.prev=1,n=t.url,a=t.date,l.next=5,Object(ge.d)(function(e){return e.map.latlng});case 5:if(r=l.sent,c=r.lat,o=r.lng,!c||!o){l.next=16;break}return l.next=11,je("".concat(Oe.police,"/crimes-street/").concat(n,"?lat=").concat(c,"&lng=").concat(o,"&date=").concat(a));case 11:return i=l.sent,l.next=14,Object(ge.c)((s=i.data,{type:C,data:s}));case 14:l.next=18;break;case 16:return l.next=18,Object(ge.c)(S("There is no position info! Please, click the map and tell me where you want to know"));case 18:l.next=25;break;case 20:return l.prev=20,l.t0=l.catch(1),console.log(l.t0),l.next=25,Object(ge.c)(S(l.t0.message));case 25:case"end":return l.stop()}var s},ke,this,[[1,20]])}function Ie(){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ge.b)(Ae);case 2:return e.next=4,Object(ge.b)(_e);case 4:return e.next=6,Object(ge.e)(y,_e);case 6:return e.next=8,Object(ge.e)(w,Ne);case 8:case"end":return e.stop()}},Se,this)}var Le=pe.a.mark(Re),Te=pe.a.mark(Pe);function Re(e){var t,n,a,r;return pe.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.id,c.prev=1,c.next=4,Object(ge.d)(function(e){return e.search.crimes});case 4:return n=c.sent,a=n&&n.filter(function(e){var n=e.location,a=(n=void 0===n?{}:n).street;return(a=void 0===a?{}:a).id===t}),console.log("selectedCrimes",a),r=a.map(function(e){var t=e.id,n=e.month,a=e.category,r=e.location,c=(r=void 0===r?{}:r).street,o=(c=void 0===c?{}:c).name,i=e.outcome_status,l=e.outcomes;return{id:t,list:[["month",n],["category",a],["street",o],["outcome status",(l=void 0===l?i||{}:l).category]]}}),c.next=10,Object(ge.c)({type:F,data:{crimeTable:r}});case 10:c.next=16;break;case 12:return c.prev=12,c.t0=c.catch(1),c.next=16,Object(ge.c)((o=c.t0.message,{type:z,message:o}));case 16:case"end":return c.stop()}var o},Le,this,[[1,12]])}function Pe(){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ge.e)(U,Re);case 2:case"end":return e.stop()}},Te,this)}var Me=pe.a.mark(De);function De(){return pe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ge.a)([Ie,Pe].map(ge.b));case 2:case"end":return e.stop()}},Me,this)}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ue=Object(s.a)(),Fe=Object(l.createStore)(de,Object(u.composeWithDevTools)(Object(l.applyMiddleware)(Ue)));Ue.run(De),o.a.render(r.a.createElement(i.a,{store:Fe},r.a.createElement(ie,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[101,2,1]]]);
//# sourceMappingURL=main.cfcd293f.chunk.js.map